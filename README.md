Розділ 2. Побудова аналітичного звіту засобами Power BI
2.1. Постановка задачі, її опис 
Задачею є проаналізувати дані фільмів що вже вийшли та зробити їх візуалізацію на аналітичній платформі Power BI. Обов’язковими елементами візуалізації є таблиця або матриця, стовпчикова діаграма, кругова або кільцева діаграма, графік та карта. Результатом виконання задачі є аналітичний звіт. 
Вхідною інформацією для розв’язування задачі є дані касових зборів країн світу за 2021 та 2022 рік . Було створено базу даних, яка містить дані перегляду фільмів згідно до днів неділі та дані рейтингу, популярності, оцінки фільмів з 2015 по 2022 рік. 
Вихідної інформацією є аналітичний звіт, де засобами візуалізації платформи Power BI було зображено основні показники впливу, які впливають на комерційний успіх та рейтинг фільмів.
Першим етапом практичної роботи є збір даних з джерел. Головною таблицею сталі дані вивантаженні з сайту IMDb (веб-сайт із вільно редагованою та найбільшою у світі базою даних про кінематограф)[11], офіційний сайт збору інформації [12], та відкриті бази даних [13].
Наступним етапом є імпорт даних до аналітичної системи Power BI. 
Отриманні таблиці були перетворені та завантаженні в форматі «.csv».
Після чого завдяки редактора запитів Power Query здійснили трансформацію даних. В ході трансформації встановила заголовки стовпців, обрала типи даних, такі як дата, текст, десяткове число. Для певних стовпців встановила грошовий формат та грошову одиницю.
Побудувала взаємодії в моделі даних (рис. 2.2). Організована структура таблиць та зв'язків між ними і називається моделлю даних. Модель є ключовим елементом звіту, тому до її розробки необхідно підходити відповідально,  неправильна організація даних може сильно ускладнити обчислення, або навіть призвести до некоректного відображення даних, що буде складно відстежити на етапі візуалізації.
![image](https://github.com/user-attachments/assets/764dbb67-b5e7-4bcd-b9ba-a15482db9efe)
Рисунок 2.1 Фрагмент початкових даних[Авторська розробка]
![image](https://github.com/user-attachments/assets/386d7c05-3976-4478-b7dd-81ef02a3297b)
Рисунок 2.2 Схема даних[Авторська розробка]
Центральною таблицею є data, з якою з’єднані інші таблиці.
2.2. Створення мір, обчислювальних стовпців та візуалізації
Для отримання більш детального аналізу даних створюємо стовбці та міри. Серед обчислювальних стовпців :
1)	Margin – таблиця data. Даний стовбець був створений для подальшого обчислення валового прибутку до доходу. Стовбець  Mergin розраховується за формулою (рис. 2.3) Margin = [revenue]-[budget]. 
2)	 Margin profit- таблиця data. Даний показник розраховується 20 через функцію DIVIDE (рис. 2.4): Margin profit = DIVIDE([Margin],[revenue],BLANK())
![image](https://github.com/user-attachments/assets/1854e978-f52f-42bf-bb69-8d6143dd5047)
Рисунок 2.3 Розрахунок Margin[Авторська розробка]
![image](https://github.com/user-attachments/assets/a87b9831-7df6-48e4-a1cc-ab514e9d141f)
Рисунок 2.4 Розрахунок Margin profit[Авторська розробка]
Також була створено 2 міри що показують сумарний та середній дохід за 2021 та 2022 роки. Щоб створити міру необхідно на вкладці «Головна» в розділі «Обчислення» обрати «Створити міру». Далі ввести вираз DAX, який обчислює значення на основі даних. У відповідних таблицях створюється міри. Так само для розрахунку обчислювальних стовпців необхідно виконати певні дії. В результаті обчислення буде створено стовпці з підрахунками по кожному рядку. Стовпці будуть додані до таблиць. 
Створені міри: 
1) Sum Profit – міра, яка обчислює сумарний дохід. Міра розраховується завдяки функції SUM (рис. 2.5): Sum Profit = SUM(country2022[Total Worldwide Box Office]). Створюємо Sum Profit1 в таблиці country2021(рис. 2.6).
2) Average Profit – міра, яка обчислює середню кількість випущених фільмів. Міра розраховується завдяки функції Average (рис. 2.7): Average Profit = AVERAGE(country2022[Number of Movies])
![image](https://github.com/user-attachments/assets/d7331398-432d-45ae-9e22-ab88d33b97cc)
Рисунок 2.5 Створена міра Sum Profit для таблиці country2022[Авторська розробка]
![image](https://github.com/user-attachments/assets/34c3193e-03b9-4add-8e23-0e35d736c0ff)
Рисунок 2.6 Створена міра Sum Profit1 для таблиці country2021[Авторська розробка]
![image](https://github.com/user-attachments/assets/e0031c4b-c6f8-4f70-a6a9-cae3c8466c8e)
Рисунок 2.7 Створена міра Average Profit для таблиці country2022[Авторська розробка]
Для повного аналізу доходу фільмів створімо міру MAX та MIN, щоб відобразити вже проаналізовані дані згодом.
3) Max Profit – для таблиці data. Використовуємо функцію MAX, яка знаходить найбільше число.(рис. 2.8): Max Profit = MAX([Margin])
![image](https://github.com/user-attachments/assets/7e02ea8d-6ac3-4df2-98b3-b3a81ee23c20)
Рисунок 2.8 Створена міра Max Profit[Авторська розробка]
4) Min Profit – для таблиці data. Використовуємо функцію MIN, яка знаходить найменьше число.(рис. 2.9): Min Profit = MIN([Margin]).
![image](https://github.com/user-attachments/assets/e8b6b8ed-1f71-4a78-aa1a-4d4bcf99f925)
Рисунок 2.9 Створена міра Min Profit[Авторська розробка]
2.3. Візуалізація даних
Після виконання попереднього етапу всі дані сформовані для проведення візуального аналізу. Результатом даного етапу є аналітичний звіт на 6 сторінках з наступною візуалізацією:
![image](https://github.com/user-attachments/assets/f833cb5e-9ad8-4dfc-b466-6be64ba46d51)
Рисунок 2.10 сторінка Release of movies[Авторська розробка]
Сторінка 1 - Release of movies (рис 2.10)  містить графік, який відображає динаміку збільшення випуску кількості фільмів с кожним роком (та спад через пандемію та ситуацію в світі). У поле осі Х було обрано Realase date, та встановлено фільтр тільки рік. Поле У – кількість title.
Сторінка 2 - Top profit (рис. 2.11) містить два графіка, та три карточки з даними. Перший графік – Top Profitable Movies, зображує найприбутковіші фільми з 1990 років по 2022. У поле «вісь» У було обрано суму Margine, що зображує чистий дохід завдяки створеній мірі, та осі Х original title. Наступний графік - Top High Budget Movies , зображує найкошторніші фільми. У поле «вісь» У було обрано суму budget, та осі Х original title. 
Карти відображають важливу інформацію для цієї сторінки, а саме Max Profit та Min profit і відповідні по ним дані, що дає змогу побачити залежність кошторності на прибуток.
![image](https://github.com/user-attachments/assets/6828605d-f74b-4967-863a-0181a04bc38d)
Рисунок 2.11 сторінка Top profit
Сторінка 3 – Votes (рис 2.12), має гістограму Топ 30 рейтингових фільмів, що показує найбільш захоплюючі фільми за думкою любителів кіно. Також до гістограми було додано та поєднано графік популярності, для відображення популярності високо оцінених фільмів. Для відображення були обрані значення original title та сума vote average, для лінії графіку даними послугували popularity. 
![image](https://github.com/user-attachments/assets/6c4b1f1a-a904-4404-9737-9bf942b6a297)
Рисунок 2.12 сторінка Votes
Сторінка 4 – Time (рис 2.13), налічує 3 графіки, графік Кількості переглядів відповідно до днів тижня, для розуміння коли найбільше глядачів зацікавлені в перегляді, графік середнього значення так званої «довжини» популярних фільмів. Та останній  Runtime vs Year зміна довжини фільмів з роком їх випуску.
Сторінка 5 – Margin (рис. 2.14) в свою чергу налічую діаграму та карту. Діаграма зібрала дані відношення популярності до доходу, завдяки чому ми можемо бачити середній дохід фільмів згідно їх популярності та умовний мінімум заробітку з фільму. Та карта що налічую прибуток за 2021 та 2022 рік по світу, що відображає вплив кіно індустрії на економіку та її більш вигідніше орієнтування ,як на споживача.
![image](https://github.com/user-attachments/assets/49fb3597-462d-45e6-8a2b-60b9903122d2)
Рисунок 2.13 сторінка Time[Авторська розробка]
![image](https://github.com/user-attachments/assets/ef9e6130-696c-4b49-ae4f-1dcb63ab8ca7)
Рисунок 2.14 сторінка Margin[Авторська розробка]
Остання сторінка – Genres (рис 2.15), відображує кругову діаграму частини випуску фільмів за даний період у жанрах, жанр та кількість фільмів була взята даними для аналізу. Та лінійну діаграму що відображає частку та кількість випущених фільмів компаніями. Даними служать кількість фільмів та самі компанії.
 ![image](https://github.com/user-attachments/assets/3b4e0c34-e3c8-43ae-9c31-9ccae1826677)
 Рисунок 2.15 сторінка Genres [Авторська розробка]
Публікація звіту
Після завершення формування звіту, опублікувала його на порталі Power BI Service. Звіт Power BI – це вміст візуалізацій (іноді розділений на кілька сторінок в одному звіті),який отримує дані з набору даних. Ви можете редагувати звіт на веб-сайті, натиснувши Редагувати звіт. Для публікації звіту необхідно на вкладці «Основне» в категорії «Надати спільний доступ», натиснути «Опублікувати». Далі – обрати місце призначення публікованого звіту. В даному випадку я обрала свою робочу область Power BI. При успішній публікації, звіт з’явиться на порталі Power BI Service (рис.2.16)
![image](https://github.com/user-attachments/assets/96fe52f0-f645-4ef9-88a0-54fa7f4953e7)
Рисунок 2.16 Опублікований звіт[Авторська розробка]
Висновок  до розділу 2
На основі отриманих даних вдалося провести аналіз комерційного успіху та факторів від яких залежить високий дохід та популярність фільмів.
Аналіз даних показав що з кожним роком вихід фільмів лише збільшується , що свідчить про розгортання нових можливостей та заробітків в цій ніші, але через пандемію та складну ситуацію в світі цього роки , різкий зріст сповільнився та зменшився. На цей час Сполученні Штати Америки мають найбільший дохід за рік. Також було виділено що наразі найбільш кошторні проекти не можуть отримати високий дохід, чи зовсім нічого можуть не заробити, било виділено оптимальну межу на основі даних , що бюджету в 200 мільйонів доларів більш ніж достатьно як верхня межа. Також оцінки глядачів про рейтинг фільмів зовсім не впливає на її популярність, тому висока оцінка не є показником прогнозованого високого прибутку. Високий перегляд фільмів перепадає на п’ятницю та на вихідні, а сам час перегляду фільмів с  кожним роком зменшюється, адже короткометражні та короткометражні фільми користуються більшою популярністю, ніж повнометражні. Найбільш популярні дані склали - драма, комедія, трилер та бойовик.
Ці данні і скаладають комерційний успіх , що не залежить від успішного рейтингу фільма.
Останнім етапом у роботі із аналітичним звітом була його публікація. Було обрано власну робочу область Power BI як місце публікації створеного звіту  

 











 





